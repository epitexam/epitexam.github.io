---
import { GITHUB_URL, SITE_TITLE } from "../consts";
import HeaderLink from "./HeaderLink.astro";
---

<header class="site-header">
	<nav class="nav-container">
		<div class="nav-section nav-brand">
			<h2 class="brand-title">
				<a href="/">{SITE_TITLE}</a>
			</h2>
			<button
				class="nav-toggle"
				aria-label="Menu navigation"
				id="menu-button"
				aria-expanded="false"
				aria-controls="nav-menu"
			>
				<svg
					viewBox="0 0 24 24"
					width="24"
					height="24"
					aria-hidden="true"
				>
					<path
						d="M3 6h18M3 12h18M3 18h18"
						stroke="currentColor"
						stroke-width="2"></path>
				</svg>
			</button>
		</div>

		<div class="nav-section nav-menu" id="nav-menu">
			<HeaderLink href="/">Home</HeaderLink>
			<HeaderLink href="/blog">Blog</HeaderLink>
			<HeaderLink href="/tools">Tools</HeaderLink>
			<HeaderLink href="/about">About</HeaderLink>
			<a
				href={GITHUB_URL}
				target="_blank"
				rel="noopener noreferrer"
				class="nav-link mobile-only"
			>
				GitHub
			</a>
		</div>

		<div class="nav-section nav-social">
			<a
				href={GITHUB_URL}
				target="_blank"
				rel="noopener noreferrer"
				aria-label="GitHub profile"
				class="social-link"
			>
				<svg
					viewBox="0 0 16 16"
					width="20"
					height="20"
					aria-hidden="true"
				>
					<path
						fill="currentColor"
						d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"
					></path>
				</svg>
			</a>
		</div>
	</nav>
</header>

<script>
	document.addEventListener("DOMContentLoaded", () => {
		const toggle = document.getElementById("menu-button");
		const menu = document.getElementById("nav-menu");

		if (!toggle || !menu) return;

		const toggleMenu = () => {
			const isExpanded = toggle.getAttribute("aria-expanded") === "true";
			toggle.setAttribute("aria-expanded", String(!isExpanded));
			menu.classList.toggle("is-open", !isExpanded);
			toggle.classList.toggle("is-active", !isExpanded);
		};

		toggle.addEventListener("click", toggleMenu);

		document.addEventListener("click", (e) => {
			const target = e.target as Node;
			if (
				!menu.contains(target) &&
				!toggle.contains(target) &&
				menu.classList.contains("is-open")
			) {
				toggleMenu();
			}
		});

		document.addEventListener("keydown", (e) => {
			if (e.key === "Escape" && menu.classList.contains("is-open")) {
				toggleMenu();
			}
		});
	});
</script>

<style>
	.site-header {
		position: sticky;
		top: 0;
		z-index: 50;
		padding: 0.75rem 1.5rem;
		background: rgba(10, 12, 20, 0.75);
		backdrop-filter: blur(16px) saturate(180%);
		-webkit-backdrop-filter: blur(16px) saturate(180%);
		border-bottom: 1px solid rgba(0, 255, 150, 0.2);
		box-shadow:
			0 0 25px rgba(0, 255, 150, 0.1),
			0 4px 20px rgba(0, 255, 150, 0.08);
	}

	@media (min-width: 769px) {
		.site-header {
			animation: header-glow 8s ease-in-out infinite alternate;
		}
	}

	@keyframes header-glow {
		from {
			box-shadow:
				0 0 20px rgba(0, 255, 150, 0.1),
				0 4px 20px rgba(0, 255, 150, 0.08);
			border-bottom-color: rgba(0, 255, 150, 0.2);
		}
		to {
			box-shadow:
				0 0 40px rgba(0, 255, 150, 0.15),
				0 4px 25px rgba(0, 255, 150, 0.12);
			border-bottom-color: rgba(0, 255, 150, 0.3);
		}
	}

	.nav-container {
		display: flex;
		align-items: center;
		justify-content: space-between;
		gap: 1.5rem;
		max-width: 1200px;
		margin: 0 auto;
	}

	.nav-section {
		display: flex;
		align-items: center;
	}

	.nav-brand {
		gap: 1rem;
		flex-shrink: 0;
	}

	.brand-title {
		margin: 0;
		font-size: 1.25rem;
	}

	.brand-title a {
		color: rgb(var(--text));
		text-decoration: none;
		text-shadow: 0 0 12px rgba(var(--accent), 0.25);
		transition: text-shadow 0.3s ease;
	}

	.brand-title a:hover {
		text-shadow: 0 0 20px rgba(var(--accent), 0.6);
	}

	.brand-title a:focus-visible {
		outline: 2px solid rgb(var(--accent));
		outline-offset: 2px;
	}

	.nav-menu {
		gap: 1.5rem;
	}

	.nav-link {
		padding: 0.5rem 0.75rem;
		color: rgb(var(--text));
		text-decoration: none;
		border-radius: 0.25rem;
		transition: all 0.2s ease;
		position: relative;
	}

	.nav-link:hover {
		color: rgb(var(--accent));
		text-shadow: 0 0 8px rgba(var(--accent), 0.8);
	}

	.nav-link:focus-visible {
		outline: 2px solid rgb(var(--accent));
		outline-offset: 2px;
	}

	.social-link {
		display: flex;
		align-items: center;
		padding: 0.5rem;
		border-radius: 0.25rem;
		transition: all 0.2s ease;
	}

	.social-link:hover svg {
		fill: rgb(var(--accent));
		filter: drop-shadow(0 0 8px rgba(var(--accent), 0.6));
	}

	.social-link:focus-visible {
		outline: 2px solid rgb(var(--accent));
		outline-offset: 2px;
	}

	.nav-toggle {
		display: none;
		background: none;
		border: none;
		padding: 0.5rem;
		color: rgb(var(--text));
		cursor: pointer;
		border-radius: 0.25rem;
		transition: filter 0.2s ease;
	}

	.nav-toggle:hover {
		filter: drop-shadow(0 0 8px rgba(var(--accent), 0.6));
	}

	.nav-toggle:focus-visible {
		outline: 2px solid rgb(var(--accent));
		outline-offset: 2px;
	}

	.mobile-only {
		display: none;
	}

	@media (max-width: 768px) {
		.site-header {
			padding: 0.75rem 1rem;

			backdrop-filter: blur(12px) saturate(160%);
			-webkit-backdrop-filter: blur(12px) saturate(160%);
			animation: none;
			box-shadow:
				0 0 15px rgba(0, 255, 150, 0.05),
				0 2px 10px rgba(0, 255, 150, 0.05);
		}

		.nav-container {
			flex-wrap: wrap;
		}

		.nav-brand {
			width: 100%;
			justify-content: space-between;
		}

		.nav-toggle {
			display: flex;
		}

		.nav-menu {
			width: 100%;
			flex-direction: column;
			gap: 0.75rem;
			max-height: 0;
			overflow: hidden;
			transition: max-height 0.3s ease;
		}

		.nav-menu.is-open {
			max-height: 300px;
		}

		.nav-social {
			display: none;
		}

		.mobile-only {
			display: block;
		}

		.nav-link {
			width: 100%;
			text-align: center;
			padding: 0.75rem;
		}

		.brand-title a {
			text-shadow: 0 0 8px rgba(var(--accent), 0.15);
		}
	}

	@supports not (backdrop-filter: blur(1px)) {
		.site-header {
			background: rgba(10, 12, 20, 0.95);
		}
	}

	@media (max-width: 480px) {
		.site-header {
			padding: 0.5rem 0.75rem;
		}

		.nav-menu {
			gap: 0.5rem;
		}
	}

	@media (prefers-reduced-motion: reduce) {
		.site-header {
			animation: none;
		}

		.nav-menu {
			transition: none;
		}

		.brand-title a,
		.nav-link,
		.social-link,
		.nav-toggle {
			transition: none;
		}
	}
</style>
